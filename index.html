<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Defense Game - Version 1.0</title>
    <style>
        body {
            display: flex;
        }
        #game-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        #game-board {
            display: grid;
            grid-template-columns: repeat(9, 1fr);
            grid-template-rows: repeat(9, 1fr);
            gap: 2px;
            margin-top: 20px;
        }
        .cell {
            border: 1px solid black;
            text-align: center;
            font-size: 24px;
            font-weight: bold;
            padding: 8px;
            cursor: pointer;
            position: relative;
        }
        .fort {
            background-color: #0066ff;
            color: white;
        }
        .turret {
            background-color: #ff9900;
            color: white;
        }
        .bullet {
            position: absolute;
            width: 5px;
            height: 5px;
            background-color: black;
            transition: transform 2s;
        }
        #controls {
            display: flex;
            justify-content: space-around;
            width: 100%;
        }
        #end-screen {
            display: none;
        }
    </style>
</head>
<body>
    <div id="controls">
        <div>
            <p>Player 1 Points: <span id="player1Points">12</span></p>
            <div class="health-bar" id="fort1HealthContainer">
                <div class="health" id="fort1Health" style="width: 100%; height: 20px; background: green;"></div>
            </div>
        </div>
        <div>
            <p>Player 2 Points: <span id="player2Points">12</span></p>
            <div class="health-bar" id="fort2HealthContainer">
                <div class="health" id="fort2Health" style="width: 100%; height: 20px; background: green;"></div>
            </div>
        </div>
    </div>
    <div id="game-container">
        <h1>Defense Game</h1>
        <div id="game-board">
            <!-- Cells will be added dynamically -->
        </div>
        <div id="end-screen">
            <p id="winner-message"></p>
        </div>
    </div>
    <script>
        const gridSize = 9;
        const boardState = Array(gridSize).fill(null).map(() => Array(gridSize).fill(null));
        let currentPlayer = 1;
        let player1Points = 12;
        let player2Points = 12;
        const playerFortHealth = [10, 10];

        const gameBoard = document.getElementById('game-board');

        function initializeBoard() {
            for (let i = 0; i < gridSize; i++) {
                for (let j = 0; j < gridSize; j++) {
                    const cell = document.createElement('div');
                    cell.classList.add('cell');
                    cell.dataset.row = i;
                    cell.dataset.col = j;

                    cell.addEventListener('click', () => placeTurret(i, j));

                    gameBoard.appendChild(cell);
                }
            }
            // Initialize forts
            boardState[0][4] = 'Fort1';
            boardState[8][4] = 'Fort2';
            document.querySelector(`.cell[data-row="0"][data-col="4"]`).classList.add('fort');
            document.querySelector(`.cell[data-row="8"][data-col="4"]`).classList.add('fort');
        }

        function placeTurret(row, col) {
            if (currentPlayer === 1 && player1Points >= 3 && !boardState[row][col]) {
                boardState[row][col] = 'Turret1';
                player1Points -= 3;
                document.querySelector(`.cell[data-row="${row}"][data-col="${col}"]`).classList.add('turret');
                updatePoints();
                fireTurret(row, col);
                currentPlayer = 2;
            } else if (currentPlayer === 2 && player2Points >= 3 && !boardState[row][col]) {
                boardState[row][col] = 'Turret2';
                player2Points -= 3;
                document.querySelector(`.cell[data-row="${row}"][data-col="${col}"]`).classList.add('turret');
                updatePoints();
                fireTurret(row, col);
                currentPlayer = 1;
            }
        }

        function fireTurret(row, col) {
            const bullet = document.createElement('div');
            bullet.className = 'bullet';
            const cell = document.querySelector(`.cell[data-row="${row}"][data-col="${col}"]`);
            cell.appendChild(bullet);

            const interval = setInterval(() => {
                if (bullet.style.transform === '') {
                    bullet.style.transform = `translate(${col * 40}px, ${row * 40}px)`;
                } else {
                    bullet.style.transform += 'translate(0, -40px)';
                }

                // Check for collision with structures
                const targetRow = row - 1;
                if (targetRow >= 0) {
                    const targetCell = boardState[targetRow][col];
                    if (targetCell) {
                        damageStructure(targetRow, col);
                        clearInterval(interval);
                        bullet.remove();
                    }
                }
            }, 1000);
        }

        function damageStructure(row, col) {
            if (boardState[row][col] === 'Fort1') {
                playerFortHealth[0]--;
                updateHealthBars();
                if (playerFortHealth[0] <= 0) endGame(2);
            } else if (boardState[row][col] === 'Fort2') {
                playerFortHealth[1]--;
                updateHealthBars();
                if (playerFortHealth[1] <= 0) endGame(1);
            }
        }

        function updatePoints() {
            document.getElementById('player1Points').textContent = player1Points;
            document.getElementById('player2Points').textContent = player2Points;
        }

        function updateHealthBars() {
            document.getElementById('fort1Health').style.width = (playerFortHealth[0] * 10) + '%';
            document.getElementById('fort2Health').style.width = (playerFortHealth[1] * 10) + '%';
        }

        function endGame(winner) {
            document.getElementById('winner-message').textContent = `Player ${winner} wins!`;
            document.getElementById('end-screen').style.display = 'block';
            // Disable further actions
            document.querySelectorAll('.cell').forEach(cell => cell.style.pointerEvents = 'none');
        }

        initializeBoard();
    </script>
</body>
</html>
